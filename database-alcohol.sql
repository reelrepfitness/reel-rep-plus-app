-- Create alcohol table
CREATE TABLE IF NOT EXISTS public.alcohol (
    id UUID DEFAULT gen_random_uuid() PRIMARY KEY,
    name TEXT NOT NULL,
    drink_type TEXT NOT NULL,
    amount NUMERIC NOT NULL DEFAULT 1,
    measurement_method TEXT NOT NULL,
    calories NUMERIC NOT NULL DEFAULT 0,
    protein_units NUMERIC NOT NULL DEFAULT 0,
    carbs_units NUMERIC NOT NULL DEFAULT 0,
    fats_units NUMERIC NOT NULL DEFAULT 0,
    img_url TEXT,
    created_at TIMESTAMPTZ DEFAULT NOW(),
    updated_at TIMESTAMPTZ DEFAULT NOW()
);

-- Enable Row Level Security
ALTER TABLE public.alcohol ENABLE ROW LEVEL SECURITY;

-- Create policies
CREATE POLICY "Allow public read access to alcohol"
    ON public.alcohol FOR SELECT
    TO public
    USING (true);

CREATE POLICY "Allow authenticated users to insert alcohol"
    ON public.alcohol FOR INSERT
    TO authenticated
    WITH CHECK (true);

CREATE POLICY "Allow authenticated users to update alcohol"
    ON public.alcohol FOR UPDATE
    TO authenticated
    USING (true)
    WITH CHECK (true);

CREATE POLICY "Allow authenticated users to delete alcohol"
    ON public.alcohol FOR DELETE
    TO authenticated
    USING (true);

-- Create index for faster queries
CREATE INDEX IF NOT EXISTS idx_alcohol_name ON public.alcohol(name);
CREATE INDEX IF NOT EXISTS idx_alcohol_drink_type ON public.alcohol(drink_type);

-- Insert all alcohol data
INSERT INTO public.alcohol (name, drink_type, amount, measurement_method, calories, protein_units, carbs_units, fats_units, img_url, created_at, updated_at) VALUES
-- לימונצ'לו
('לימונצ''לו', 'מנה', 1, 'שוט/מנה', 120, 0, 1, 0, '', '2025-06-13T14:20:31.737Z', '2025-06-13T14:20:31.737Z'),
('לימונצ''לו', 'צ''ייסר', 1, 'צ''ייסר', 75, 0, 1, 0, '', '2025-06-13T14:20:31.724Z', '2025-06-13T14:20:31.724Z'),

-- קמפרי
('קמפרי', 'מנה', 1, 'שוט/מנה', 112, 0, 1, 0, '', '2025-06-13T14:20:31.735Z', '2025-06-13T14:20:31.735Z'),
('קמפרי', 'צ''ייסר', 1, 'צ''ייסר', 70, 0, 1, 0, '', '2025-06-13T14:20:31.723Z', '2025-06-13T14:20:31.723Z'),

-- אמרטו
('אמרטו', 'מנה', 1, 'שוט/מנה', 128, 0, 1.5, 0, '', '2025-06-13T14:20:31.734Z', '2025-06-13T14:20:31.734Z'),
('אמרטו', 'צ''ייסר', 1, 'צ''ייסר', 80, 0, 1, 0, '', '2025-06-13T14:20:31.722Z', '2025-06-13T14:20:31.722Z'),

-- בייליס (ליקר שמנת)
('בייליס (ליקר שמנת)', 'מנה', 1, 'שוט/מנה', 136, 0, 1.5, 0, '', '2025-06-13T14:20:31.733Z', '2025-06-13T14:20:31.733Z'),
('בייליס (ליקר שמנת)', 'צ''ייסר', 1, 'צ''ייסר', 85, 0, 1, 0, '', '2025-06-13T14:20:31.721Z', '2025-06-13T14:20:31.721Z'),

-- ג'ין
('ג''ין', 'מנה', 1, 'שוט/מנה', 88, 0, 1, 0, '', '2025-06-13T14:20:31.732Z', '2025-06-13T14:20:31.732Z'),
('ג''ין', 'צ''ייסר', 1, 'צ''ייסר', 55, 0, 0.5, 0, '', '2025-06-13T14:20:31.721Z', '2025-06-13T14:20:31.721Z'),

-- ברנדי
('ברנדי', 'מנה', 1, 'שוט/מנה', 96, 0, 1, 0, '', '2025-06-13T14:20:31.731Z', '2025-06-13T14:20:31.731Z'),
('ברנדי', 'צ''ייסר', 1, 'צ''ייסר', 60, 0, 0.5, 0, '', '2025-06-13T14:20:31.720Z', '2025-06-13T14:20:31.720Z'),

-- רום
('רום', 'מנה', 1, 'שוט/מנה', 88, 0, 1, 0, '', '2025-06-13T14:20:31.730Z', '2025-06-13T14:20:31.730Z'),
('רום', 'צ''ייסר', 1, 'צ''ייסר', 55, 0, 0.5, 0, '', '2025-06-13T14:20:31.719Z', '2025-06-13T14:20:31.719Z'),

-- אוזו
('אוזו', 'מנה', 1, 'שוט/מנה', 96, 0, 1, 0, '', '2025-06-13T14:20:31.729Z', '2025-06-13T14:20:31.729Z'),
('אוזו', 'צ''ייסר', 1, 'צ''ייסר', 60, 0, 0.5, 0, '', '2025-06-13T14:20:31.718Z', '2025-06-13T14:20:31.718Z'),

-- ערק
('ערק', 'מנה', 1, 'שוט/מנה', 96, 0, 1, 0, '', '2025-06-13T14:20:31.728Z', '2025-06-13T14:20:31.728Z'),
('ערק', 'צ''ייסר', 1, 'צ''ייסר', 60, 0, 0.5, 0, '', '2025-06-13T14:20:31.717Z', '2025-06-13T14:20:31.717Z'),

-- טקילה
('טקילה', 'מנה', 1, 'שוט/מנה', 88, 0, 1, 0, '', '2025-06-13T14:20:31.727Z', '2025-06-13T14:20:31.727Z'),
('טקילה', 'צ''ייסר', 1, 'צ''ייסר', 55, 0, 0.5, 0, '', '2025-06-13T14:20:31.717Z', '2025-06-13T14:20:31.717Z'),

-- וויסקי
('וויסקי', 'מנה', 1, 'שוט/מנה', 88, 0, 1, 0, '', '2025-06-13T14:20:31.726Z', '2025-06-13T14:20:31.726Z'),
('וויסקי', 'צ''ייסר', 1, 'צ''ייסר', 55, 0, 0.5, 0, '', '2025-06-13T14:20:31.716Z', '2025-06-13T14:20:31.716Z'),

-- וודקה
('וודקה', 'מנה', 1, 'שוט/מנה', 88, 0, 1, 0, '', '2025-06-13T14:20:31.725Z', '2025-06-13T14:20:31.725Z'),
('וודקה', 'צ''ייסר', 1, 'צ''ייסר', 55, 0, 0.5, 0, '', '2025-06-13T14:20:31.713Z', '2025-06-13T14:20:31.713Z'),

-- יין קברנה חצי יבש
('יין קברנה חצי יבש', 'יינות', 1, 'כוס יין (כ-150 מ"ל)', 140, 0, 0.5, 0, '', '2025-06-13T14:20:31.712Z', '2025-06-13T14:20:31.712Z'),

-- יין תירוש
('יין תירוש', 'יינות', 1, 'כוס יין (כ-150 מ"ל)', 180, 0, 1, 0, '', '2025-06-13T14:20:31.711Z', '2025-06-13T14:20:31.711Z'),

-- אמרנה / למברוסקו
('אמרנה / למברוסקו', 'יינות', 1, 'כוס יין (כ-150 מ"ל)', 150, 0, 0.5, 0, '', '2025-06-13T14:20:31.711Z', '2025-06-13T14:20:31.711Z'),

-- מוסקט
('מוסקט', 'יינות', 1, 'כוס יין (כ-150 מ"ל)', 160, 0, 0.5, 0, '', '2025-06-13T14:20:31.710Z', '2025-06-13T14:20:31.710Z'),

-- פורט
('פורט', 'יינות', 1, 'כוס יין (כ-150 מ"ל)', 180, 0, 1, 0, '', '2025-06-13T14:20:31.709Z', '2025-06-13T14:20:31.709Z'),

-- יין רוזה
('יין רוזה', 'יינות', 1, 'כוס יין (כ-150 מ"ל)', 128, 0, 0.5, 0, '', '2025-06-13T14:20:31.708Z', '2025-06-13T14:20:31.708Z'),

-- יין לבן חצי יבש
('יין לבן חצי יבש', 'יינות', 1, 'כוס יין (כ-150 מ"ל)', 130, 0, 0.5, 0, '', '2025-06-13T14:20:31.707Z', '2025-06-13T14:20:31.707Z'),

-- יין לבן יבש
('יין לבן יבש', 'יינות', 1, 'כוס יין (כ-150 מ"ל)', 120, 0, 0.5, 0, '', '2025-06-13T14:20:31.706Z', '2025-06-13T14:20:31.706Z'),

-- יין אדום יבש
('יין אדום יבש', 'יינות', 1, 'כוס יין (כ-150 מ"ל)', 125, 0, 0.5, 0, '', '2025-06-13T14:20:31.705Z', '2025-06-13T14:20:31.705Z'),

-- בקס חצי
('בקס חצי', 'בירות', 1, 'חצי (500 מ"ל)', 205, 0, 2, 0, '', '2025-06-13T14:20:31.699Z', '2025-08-20T13:28:11.624Z'),

-- וויינשטפן
('וויינשטפן', 'בירות', 1, 'חצי (500 מ"ל)', 265, 0, 2.5, 0, '', '2025-06-13T14:20:31.667Z', '2025-08-20T13:23:04.465Z'),
('וויינשטפן', 'בירות', 1, 'שליש (330 מ"ל)', 175, 0, 1.5, 0, '', '2025-06-13T14:20:31.656Z', '2025-06-13T14:20:31.656Z'),

-- לף בלונד
('לף בלונד', 'בירות', 1, 'חצי (500 מ"ל)', 295, 0, 2.5, 0, '', '2025-06-13T14:20:31.666Z', '2025-06-13T14:20:31.666Z'),

-- מכבי
('מכבי', 'בירות', 1, 'חצי (500 מ"ל)', 235, 0, 2, 0, '', '2025-06-13T14:20:31.665Z', '2025-06-13T14:20:31.665Z'),
('מכבי', 'בירות', 1, 'שליש (330 מ"ל)', 155, 0, 1.5, 0, '', '2025-06-13T14:20:31.654Z', '2025-06-13T14:20:31.654Z'),

-- קרלסברג
('קרלסברג', 'בירות', 1, 'חצי (500 מ"ל)', 210, 0, 2, 0, '', '2025-06-13T14:20:31.664Z', '2025-06-13T14:20:31.664Z'),
('קרלסברג', 'בירות', 1, 'שליש (330 מ"ל)', 140, 0, 1.5, 0, '', '2025-06-13T14:20:31.653Z', '2025-06-13T14:20:31.653Z'),

-- סטלה
('סטלה', 'בירות', 1, 'חצי (500 מ"ל)', 230, 0, 2, 0, '', '2025-06-13T14:20:31.663Z', '2025-08-20T13:22:16.392Z'),
('סטלה', 'בירות', 1, 'שליש (330 מ"ל)', 150, 0, 1.5, 0, '', '2025-06-13T14:20:31.652Z', '2025-06-13T14:20:31.652Z'),

-- היינקן
('היינקן', 'בירות', 1, 'חצי (500 מ"ל)', 210, 0, 2, 0, '', '2025-06-13T14:20:31.663Z', '2025-06-13T14:20:31.663Z'),
('היינקן', 'בירות', 1, 'שליש (330 מ"ל)', 140, 0, 1.5, 0, '', '2025-06-13T14:20:31.651Z', '2025-06-13T14:20:31.651Z'),

-- טובורג
('טובורג', 'בירות', 1, 'חצי (500 מ"ל)', 210, 0, 2, 0, '', '2025-06-13T14:20:31.662Z', '2025-06-13T14:20:31.662Z'),
('טובורג', 'בירות', 1, 'שליש (330 מ"ל)', 140, 0, 1.5, 0, '', '2025-06-13T14:20:31.649Z', '2025-06-13T14:20:31.649Z'),

-- גולדסטאר Unfiltered
('גולדסטאר Unfiltered', 'בירות', 1, 'חצי (500 מ"ל)', 250, 0, 2.5, 0, '', '2025-06-13T14:20:31.661Z', '2025-08-20T13:22:48.772Z'),
('גולדסטאר Unfiltered', 'בירות', 1, 'שליש (330 מ"ל)', 165, 0, 1.5, 0, '', '2025-06-13T14:20:31.648Z', '2025-06-13T14:20:31.648Z'),

-- גולדסטאר
('גולדסטאר', 'בירות', 1, 'חצי (500 מ"ל)', 220, 0, 2, 0, '', '2025-06-13T14:20:31.660Z', '2025-06-13T14:20:31.660Z'),
('גולדסטאר', 'בירות', 1, 'שליש (330 מ"ל)', 150, 0, 1.5, 0, '', '2025-06-13T14:20:31.639Z', '2025-06-13T14:20:31.639Z'),

-- רדברג
('רדברג', 'בירות', 1, 'שליש (330 מ"ל)', 150, 0, 1.5, 0, '', '2025-06-13T14:20:31.659Z', '2025-06-13T14:20:31.659Z'),

-- בלו מון
('בלו מון', 'בירות', 1, 'שליש (330 מ"ל)', 180, 0, 1.5, 0, '', '2025-06-13T14:20:31.658Z', '2025-06-13T14:20:31.658Z'),

-- אנגלהרדט
('אנגלהרדט', 'בירות', 1, 'שליש (330 מ"ל)', 145, 0, 1.5, 0, '', '2025-06-13T14:20:31.658Z', '2025-06-13T14:20:31.658Z'),

-- בקס
('בקס', 'בירות', 1, 'שליש (330 מ"ל)', 135, 0, 1.5, 0, '', '2025-06-13T14:20:31.657Z', '2025-06-13T14:20:31.657Z'),

-- קורונה
('קורונה', 'בירות', 1, 'שליש (330 מ"ל)', 135, 0, 1.5, 0, '', '2025-06-13T14:20:31.654Z', '2025-06-13T14:20:31.654Z');

-- Create function to update updated_at timestamp
CREATE OR REPLACE FUNCTION update_alcohol_updated_at()
RETURNS TRIGGER AS $$
BEGIN
    NEW.updated_at = NOW();
    RETURN NEW;
END;
$$ LANGUAGE plpgsql;

-- Create trigger to automatically update updated_at
CREATE TRIGGER update_alcohol_timestamp
    BEFORE UPDATE ON public.alcohol
    FOR EACH ROW
    EXECUTE FUNCTION update_alcohol_updated_at();
